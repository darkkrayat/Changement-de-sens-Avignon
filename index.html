<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>app changement de sens Avignon</title>
    <link rel="stylesheet" href="appleaf.css" />

    <link rel="stylesheet" href="leaflet/leaflet.css" />
    <link rel="stylesheet" href="leaflet-routing-machine-3.2.12/dist/leaflet-routing-machine.css" />
    <link rel="stylesheet" href="leaflet-control-geocoder-1.8.2/dist/Control.Geocoder.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
    <link rel="stylesheet" href="node_modules/ekko-lightbox/dist/ekko-lightbox.css" />


    <script src="leaflet/leaflet.js"></script>
    <script src="node_modules/@mapbox/corslite/corslite.js"></script>
    <script src="node_modules/@mapbox/polyline/src/polyline.js"></script>
    <script src="node_modules/lodash/lodash.js"></script>
    <script src="node_modules/lodash/lodash.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="leaflet-routing-machine-3.2.12/dist/leaflet-routing-machine.js"></script>
    <script src="leaflet-control-geocoder-1.8.2/dist/Control.Geocoder.js"></script>
    <script src="L.Routing.OpenRouteService.js"></script>
    <script src="node_modules/lrm-graphhopper/src/L.Routing.GraphHopper.js"></script>
    <script src="node_modules/ekko-lightbox/dist/ekko-lightbox.js"></script>
    

    <!-- Fullscreen Mapbox plugin -->
    <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css' rel='stylesheet' />

    

</head>

<body>

<div class="container">
<div id="myModal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Un nouveau sens au coeur de ville </h4>
      </div>
      <div class="modal-body">
        <p> ATTENTION cette cartographie est en cours de construction !! Elle sera pleinement effective ce dimanche 4 août minuit.
        </p>
        <p>Bienvenue sur la cartographie du changement de sens de l'intramuros d'Avignon. Cette cartographie a été conçue dans le but de vous faciliter vos déplacements quotidiens et de préparer votre venue dans le coeur de ville avignonais. Vous pourrez y trouver les informations sur ces modifications ainsi qu'une cartographie dynamique et actualisée pour calculer votre cheminement dans le centre-ville.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Fermer</button>
      </div>
    </div>
</div>
  </div>
</div>
    
    
    
    <div class="d-flex justify-content-around align-items-center " id="banner">
        <img src="images/avignonexception.png" class="img-fluid" id="optionalstuff" >
        <img src="images/nouveausensbanner.png" class="img-fluid banner" >
        <a href="http://www.avignon.fr" type="button" class="btn" id="optionalstuff">Retournez au site avignon.fr</a>

    </div>


    <div class="container" >
        <div class="row">
            <div class="MultiCarousel" data-items="1,3,5,6" data-slide="2" id="MultiCarousel" data-interval="2000" >
                <div class="MultiCarousel-inner" >
                    <div class="item">
                        <div class="pad15">
                            <a href="images/nouveau%20sens%20officiel.png" data-toggle="lightbox">
                            <img src="images/nouveau%20sens%20officiel.png" style="width: 100%" >
                            </a>
                        </div>
                    </div>
                    <div class="item">
                        <div class="pad15">
                             <a href="images/lesparkings.png" data-toggle="lightbox">
                            <img src="images/lesparkings.png" style="width: 100%">
                            </a>
                        </div>
                    </div>
                    <div class="item">
                        <div class="pad15">
                             <a href="images/lesrues.png" data-toggle="lightbox">
                            <img src="images/lesrues.png" style="width: 100%">
                            </a>
                        </div>
                    </div>
                    <div class="item">
                        <div class="pad15">
                             <a href="images/tarif%20nuit.png" data-toggle="lightbox">
                            <img src="images/tarif%20nuit.png" style="width: 100%">
                            </a>
                        </div>
                    </div>
                    <div class="item">
                        <div class="pad15">
                             <a href="images/4hgratuites.png" data-toggle="lightbox">
                            <img src="images/4hgratuites.png" style="width: 100%">
                            </a>
                        </div>
                    </div>
                    <div class="item">
                        <div class="pad15">
                             <a href="images/explication.png" data-toggle="lightbox">
                            <img src="images/explication.png" style="width: 100%">
                            </a>
                        </div>
                    </div>
                    <div class="item">
                        <div class="pad15">
                             <a href="images/horodateur.png" data-toggle="lightbox">
                            <img src="images/horodateur.png" style="width: 100%">
                            </a>
                        </div>
                    </div>
                    <div class="item">
                        <div class="pad15">
                             <a href="images/topo.png" data-toggle="lightbox">
                            <img src="images/topo.png" style="width: 100%">
                            </a>
                        </div>
                    </div>
                    <div class="item">
                        <div class="pad15">
                             <a href="images/accesparking.png" data-toggle="lightbox">
                            <img src="images/accesparking.png" style="width: 100%">
                            </a>
                        </div>
                    </div>
                </div>
                <button class="btn btn-primary leftLst">
                    <</button> <button class="btn btn-primary rightLst">>
                </button>
            </div>
        </div>
    </div>
  
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12" id="map-holder">
                <div id="map">
                </div>
            </div>
        </div>
    </div>
    <div id="footpage">
    </div>


    <script type="text/javascript">
        
 

        var mbAttr = 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
            '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
            'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
            mbUrl = 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw';
          // load GeoJSON from an external file
  $.getJSON("axes_qui_changent.geojson",function(data){
    // add GeoJSON layer to the map once the file is loaded
    L.geoJson(data).addTo(map);
  });
 

        var grayscale = L.tileLayer(mbUrl, {
                id: 'mapbox.light',
                attribution: mbAttr
            }),
            streets = L.tileLayer(mbUrl, {
                id: 'mapbox.streets',
                attribution: mbAttr
            });

        var map = L.map('map', {
            center: [43.9494, 4.8085],
            zoom: 16,
            layers: [grayscale],
            fullscreenControl: true,
             maxBounds: [
        //south west
        [43.933, 4.783],
        //north east
        [43.965, 4.839]
        ], 
        });

        var baseLayers = {
            "Grayscale": grayscale,
            "Streets": streets
        };

        var overlays = {
           
        };
        
        

        
        
        

        L.control.layers(baseLayers, overlays).addTo(map);


        L.Routing.control({

            waypoints: [
                L.latLng(43.9450, 4.8057),
                L.latLng(43.9587, 4.8292),
            ],
           router: new L.Routing.osrmv1({
                 language: 'fr',
                profile: 'car'
             }),
           // router: new L.Routing.Graphhopper('f5053c5e-8c5b-4dd9-87a7-066ef8942e8a'),
            geocoder: L.Control.Geocoder.bing('An3jung0oyVSEcdxz4GrGoKlG2GNPkk0HNaUtq657DxqAtN2rxdAhLUZha7lTU4n'),
            geocodewhileDragging: false,
            routeWhileDragging: false,
        }).addTo(map);



        map.isFullscreen() // Is the map fullscreen?
        map.toggleFullscreen() // Either go fullscreen, or cancel the existing fullscreen.

        // `fullscreenchange` Event that's fired when entering or exiting fullscreen.
        map.on('fullscreenchange', function() {
            if (map.isFullscreen()) {
                console.log('entered fullscreen');
            } else {
                console.log('exited fullscreen');
            }
        });

    </script>



    <script>
        $(document).ready(function() {
            $('#myModal').modal('show');
            var itemsMainDiv = ('.MultiCarousel');
            var itemsDiv = ('.MultiCarousel-inner');
            var itemWidth = "";

            $('.leftLst, .rightLst').click(function() {
                var condition = $(this).hasClass("leftLst");
                if (condition)
                    click(0, this);
                else
                    click(1, this)
            });

            ResCarouselSize();




            $(window).resize(function() {
                ResCarouselSize();
            });

            //this function define the size of the items
            function ResCarouselSize() {
                var incno = 0;
                var dataItems = ("data-items");
                var itemClass = ('.item');
                var id = 0;
                var btnParentSb = '';
                var itemsSplit = '';
                var sampwidth = $(itemsMainDiv).width();
                var bodyWidth = $('body').width();
                $(itemsDiv).each(function() {
                    id = id + 1;
                    var itemNumbers = $(this).find(itemClass).length;
                    btnParentSb = $(this).parent().attr(dataItems);
                    itemsSplit = btnParentSb.split(',');
                    $(this).parent().attr("id", "MultiCarousel" + id);


                    if (bodyWidth >= 1200) {
                        incno = itemsSplit[3];
                        itemWidth = sampwidth / incno;
                    } else if (bodyWidth >= 992) {
                        incno = itemsSplit[2];
                        itemWidth = sampwidth / incno;
                    } else if (bodyWidth >= 768) {
                        incno = itemsSplit[1];
                        itemWidth = sampwidth / incno;
                    } else {
                        incno = itemsSplit[0];
                        itemWidth = sampwidth / incno;
                    }
                    $(this).css({
                        'transform': 'translateX(0px)',
                        'width': itemWidth * itemNumbers
                    });
                    $(this).find(itemClass).each(function() {
                        $(this).outerWidth(itemWidth);
                    });

                    $(".leftLst").addClass("over");
                    $(".rightLst").removeClass("over");

                });
            }


            //this function used to move the items
            function ResCarousel(e, el, s) {
                var leftBtn = ('.leftLst');
                var rightBtn = ('.rightLst');
                var translateXval = '';
                var divStyle = $(el + ' ' + itemsDiv).css('transform');
                var values = divStyle.match(/-?[\d\.]+/g);
                var xds = Math.abs(values[4]);
                if (e == 0) {
                    translateXval = parseInt(xds) - parseInt(itemWidth * s);
                    $(el + ' ' + rightBtn).removeClass("over");

                    if (translateXval <= itemWidth / 2) {
                        translateXval = 0;
                        $(el + ' ' + leftBtn).addClass("over");
                    }
                } else if (e == 1) {
                    var itemsCondition = $(el).find(itemsDiv).width() - $(el).width();
                    translateXval = parseInt(xds) + parseInt(itemWidth * s);
                    $(el + ' ' + leftBtn).removeClass("over");

                    if (translateXval >= itemsCondition - itemWidth / 2) {
                        translateXval = itemsCondition;
                        $(el + ' ' + rightBtn).addClass("over");
                    }
                }
                $(el + ' ' + itemsDiv).css('transform', 'translateX(' + -translateXval + 'px)');
            }

            //It is used to get some elements from btn
            function click(ell, ee) {
                var Parent = "#" + $(ee).parent().attr("id");
                var slide = $(Parent).attr("data-slide");
                ResCarousel(ell, Parent, slide);
            }

        });

    </script>

    <script>
        var resize_map = {};
        resize_map.mapmargin = 0;
        resize_map.minHeight = 415;
        resize_map.getHeight = function() {
            this.mapmargin = $('.container-fluid').height();
        };

        resize_map.getHeight();
        $(window).bind("resize", resize);
        resize();

        function resize() {
            if ($(window).width() >= resize_map.minHeight) {
                $('#map').css("height", ($(window).height() - resize_map.mapmargin));
                // setTimeout, to Handle using the Maximize button which needs more time to respond correctly
                setTimeout(function() {
                    $('#map').css("height", ($(window).height() - resize_map.mapmargin));
                }, 150);
                // Set the map size cannot be smaller than the width on mobile devices.
            } else {
                if ($(window).height() <= resize_map.minHeight) {
                    $('#map').css("height", resize_map.minHeight);
                } else {
                    $('#map').css("height", ($(window).height() - resize_map.mapmargin));
                }
            }
        }

    </script>
        
    <script>
    $(document).on('click', '[data-toggle="lightbox"]', function(event) {
                event.preventDefault();
                $(this).ekkoLightbox();
            });    
    </script>
        


</body>

</html>
